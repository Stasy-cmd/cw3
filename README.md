# Код курсовой работы №3

## Описание проекта
1)- организуем страницы с регистрацией и аутентификацией на основе уже изученной спецификации JWT

У каждого пользователя будет страница с его профилем, где он сможет выбрать любимый жанр, указать имя и фамилию, а также в случае необходимости сменить пароль
Еще для пользователя нужно реализовать механизм добавления и удаления фильмов в/из закладок, а также просмотр всех сохраненных в закладки фильмов.

2)- нужно добавить самые главные сущности — фильмы, режиссеры и жанры. Для них сделаем лишь возможность чтения (get-запросы)

Для всех объектов будет работать пагинация, чтобы мы могли постранично выводить их на экран, а также можно будет посмотреть самые новые фильмы.

#Шаг 1. Создание моделей
Необходимы следующие таблицы:
- Жанры (создана)
- Режиссеры
- Фильмы
- Пользователи

Модель с фильмами имеет следующие поля:

- **id** - первичный ключ
- **title**- название
- **description** - описание
- **trailer** - ссылка на трейлер
- **year** - год выпуска
- **rating** - рейтинг
- **genre_id** - id жанра
- **director_id**  - id режиссера

Модель пользователя имеет следующие поля:

- **id** - первичный ключ
- **email -** по нему будет осуществлен доступ на сайт (*уникальное*)
- **password** — не забывайте, что пароль тут будет в хешированном виде
- name - имя
- surname - фамилия
- favorite_genre - любимый жанр

нужно проверить, что все импортированные модели создаются корректно, и сделать коммит.

#Шаг 2. Создание DAO, сервисов и вьюх для фильмов, жанров и режиссеров

На данном шаге мы реализуем следующие эндпоинты:
- **GET** /movies/
- **GET** /movies/{id}
- **GET** /genres/
- **GET** /genres/{id}
- **GET** /directors/
- **GET** /directors/{id}

Для тех эндпоинтов, которые возвращают несколько записей, нужно организовать пагинацию через URL-параметр page, а на страницу будет возвращать по 12 записей
нужно еще добавить необязательный параметр status. Если он присутствует и имеет значение new — возвращаем записи в отсортированном виде (самые свежие), иначе возвращаем в том порядке, в котором они лежат в базе
Запрос может выглядеть так:
- */movies/?status=new&page=1*
- */movies/?page=2*
- */movies/*

# Шаг 3. Создание страниц авторизации

Для реализации авторизации мы напишем следующие три эндпоинта:
- **POST** /auth/register — передавая  email и пароль, создаем пользователя в системе.
- **POST** /auth/login — передаем email и пароль и, если пользователь прошел аутентификацию, возвращаем пользователю ответ в виде:
    
    ```json
    {
       "access_token": "qwesfsdfa",
       "refresh_token": "kjhgfgjakda",
    }
    ```
- **PUT** /auth/login — принимаем пару токенов и, если они валидны, создаем пару новых.

На данном этапе нужно обязательно проверить работу механизма аутентификации через Postman (или используйте любой другой инструмент) 

Теперь сделаем коммит и приступим к последнему шагу.


# Шаг 4. Работа с пользователем

Реализуем следующие эндпоинты:

- **GET** /user/ — получить информацию о пользователе (его профиль).
- **PATCH** /user/ — изменить информацию пользователя (имя, фамилия, любимый жанр).
- **PUT** /user/password — обновить пароль пользователя, для этого нужно отправить два пароля *password_1* и *password_2.*

Для того чтобы все  ссылки корректно работали, их нужно обернуть в декоратор, в котором мы будет проверять переданный токен.




